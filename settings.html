<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Settings - ChefOS POS Configuration</title>
  <meta name="description" content="System Configuration and Settings for ChefOS POS">
  <link rel="stylesheet" href="assets/css/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="app-container">
    <!-- SIDEBAR -->
    <aside class="sidebar" aria-label="Main navigation">
      <div class="sidebar-header">
        <h1><i class="fas fa-utensils" aria-hidden="true"></i> ChefOS POS</h1>
      </div>
      
      <nav class="sidebar-nav" aria-label="Primary navigation">
        <div class="nav-section">
          <h2 class="visually-hidden">Main Menu</h2>
          <h3>Menu</h3>
          <ul class="nav-links">
            <li><a href="pos.html"><i class="fas fa-cash-register" aria-hidden="true"></i> POS</a></li>
            <li><a href="orders.html"><i class="fas fa-list" aria-hidden="true"></i> Orders</a></li>
            <li><a href="kds.html"><i class="fas fa-utensils" aria-hidden="true"></i> ChefOS Line</a></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <h3>Management</h3>
          <ul class="nav-links">
            <li><a href="inventory.html"><i class="fas fa-boxes" aria-hidden="true"></i> ChefOS Stock</a></li>
            <li><a href="reports.html"><i class="fas fa-chart-bar" aria-hidden="true"></i> ChefOS Insights</a></li>
            <li><a href="settings.html" class="active" aria-current="page"><i class="fas fa-cog" aria-hidden="true"></i> Settings</a></li>
          </ul>
        </div>
      </nav>
      
      <!-- SETTINGS PANEL -->
      <div class="settings-panel" role="region" aria-label="Theme settings">
        <div class="theme-toggle">
          <span><i class="fas fa-moon" aria-hidden="true"></i> Dark Mode</span>
          <label class="toggle-switch">
            <input type="checkbox" id="themeToggle" aria-label="Toggle dark mode">
            <span class="toggle-slider" aria-hidden="true"></span>
          </label>
        </div>
      </div>
      
      <!-- HELP CENTER -->
      <section class="help-center" aria-label="Help and support">
        <h3><i class="fas fa-life-ring" aria-hidden="true"></i> Help Center</h3>
        <div class="contact-info">
          <a href="mailto:dereck@dereckmungoriwo.online">
            <i class="fas fa-envelope" aria-hidden="true"></i> dereck@dereckmungoriwo.online
          </a>
          <a href="https://wa.me/27717184048" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-whatsapp" aria-hidden="true"></i> +27 71 718 4048
          </a>
          <div>
            <i class="fas fa-clock" aria-hidden="true"></i> 24/7 Support
          </div>
        </div>
      </section>
      
      <a href="login.html" class="logout-btn">
        <i class="fas fa-sign-out-alt" aria-hidden="true"></i> Logout
      </a>
    </aside>

    <!-- MAIN CONTENT -->
    <div class="main-content">
      <!-- TOP BAR - MATCHING POS PAGE STRUCTURE -->
      <header class="top-bar" role="banner">
        <div class="header-left">
          <h1 class="app-title">ChefOS Settings Configuration</h1>
          <p class="header-motto">Control • Security • Management</p>
        </div>

        <div class="header-right">
          <!-- Time Display - Matching POS Page -->
          <div class="time-display" aria-live="polite">
            <svg class="clock-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" fill="none"/>
              <path d="M12 7v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <time id="clockText" datetime="">Loading time...</time>
          </div>

          <!-- User Info - Matching POS Page -->
          <div class="user-info">
            <div class="user-avatar" aria-label="User avatar">DM</div>
            <div class="user-meta">
              <div class="user-name">Dereck Mungoriwo</div>
              <div class="user-role">Manager</div>
            </div>
          </div>
        </div>
      </header>

      <!-- SETTINGS CONTAINER -->
      <main class="settings-container" id="main-content">
        <h2><i class="fas fa-cog" aria-hidden="true"></i> Settings</h2>
        
        <div class="settings-grid">
          <!-- APPEARANCE -->
          <section class="setting-card" aria-labelledby="appearance-heading">
            <h3 id="appearance-heading"><i class="fas fa-palette" aria-hidden="true"></i> Appearance</h3>
            <p>Customize the look and feel of your POS system</p>
            <div class="theme-toggle" style="margin-top: 20px;">
              <span>Dark Mode</span>
              <label class="toggle-switch">
                <input type="checkbox" id="themeToggleMain" aria-label="Toggle dark mode for appearance">
                <span class="toggle-slider" aria-hidden="true"></span>
              </label>
            </div>
          </section>
          
          <!-- NOTIFICATIONS -->
          <section class="setting-card" aria-labelledby="notifications-heading">
            <h3 id="notifications-heading"><i class="fas fa-bell" aria-hidden="true"></i> Notifications</h3>
            <p>Configure order and system notifications</p>
            <button class="btn btn-primary" style="margin-top: 20px;" onclick="alert('Notification settings coming soon!')" aria-label="Configure notification settings">
              <i class="fas fa-cog" aria-hidden="true"></i> Configure
            </button>
          </section>
          
          <!-- PRINTER SETTINGS -->
          <section class="setting-card" aria-labelledby="printer-heading">
            <h3 id="printer-heading"><i class="fas fa-print" aria-hidden="true"></i> Printer Settings</h3>
            <p>Configure receipt and kitchen printers</p>
            <button class="btn btn-primary" style="margin-top: 20px;" onclick="alert('Printer settings coming soon!')" aria-label="Setup printer configuration">
              <i class="fas fa-print" aria-hidden="true"></i> Setup Printer
            </button>
          </section>
          
          <!-- DATA MANAGEMENT -->
          <section class="setting-card" aria-labelledby="data-heading">
            <h3 id="data-heading"><i class="fas fa-database" aria-hidden="true"></i> Data Management</h3>
            <p>Backup and restore your POS data</p>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
              <button class="btn btn-success" onclick="backupData()" aria-label="Backup system data">
                <i class="fas fa-download" aria-hidden="true"></i> Backup
              </button>
              <button class="btn btn-secondary" onclick="clearData()" aria-label="Clear all system data">
                <i class="fas fa-trash" aria-hidden="true"></i> Clear All
              </button>
            </div>
          </section>
          
          <!-- USER MANAGEMENT -->
          <section class="setting-card" aria-labelledby="users-heading">
            <h3 id="users-heading"><i class="fas fa-users" aria-hidden="true"></i> User Management</h3>
            <p>Manage staff accounts and permissions</p>
            <button class="btn btn-primary" style="margin-top: 20px;" onclick="alert('User management coming soon!')" aria-label="Manage user accounts">
              <i class="fas fa-user-plus" aria-hidden="true"></i> Manage Users
            </button>
          </section>
          
          <!-- SUPPORT -->
          <section class="setting-card" aria-labelledby="support-heading">
            <h3 id="support-heading"><i class="fas fa-life-ring" aria-hidden="true"></i> Support</h3>
            <p>Get help and contact support</p>
            <div style="margin-top: 20px;">
              <a href="mailto:dereck@dereckmungoriwo.online" class="btn btn-primary" style="display: inline-block; text-decoration: none; margin-right: 10px;" aria-label="Email support team">
                <i class="fas fa-envelope" aria-hidden="true"></i> Email Support
              </a>
              <a href="https://wa.me/27717184048" target="_blank" rel="noopener noreferrer" class="btn btn-success" style="display: inline-block; text-decoration: none;" aria-label="Contact via WhatsApp">
                <i class="fab fa-whatsapp" aria-hidden="true"></i> WhatsApp
              </a>
            </div>
          </section>
        </div>
      </main>
    </div>
  </div>

  <script>
    // DOM Elements
    const themeToggle = document.getElementById('themeToggle');
    const themeToggleMain = document.getElementById('themeToggleMain');
    
    // Check for saved theme
    function initializeTheme() {
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      
      if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
        document.body.classList.add('dark-theme');
        if (themeToggle) themeToggle.checked = true;
        if (themeToggleMain) themeToggleMain.checked = true;
      }
    }
    
    // Theme toggle event
    function toggleTheme() {
      if (this.checked) {
        document.body.classList.add('dark-theme');
        localStorage.setItem('theme', 'dark');
        // Sync both toggles
        if (themeToggle) themeToggle.checked = true;
        if (themeToggleMain) themeToggleMain.checked = true;
      } else {
        document.body.classList.remove('dark-theme');
        localStorage.setItem('theme', 'light');
        // Sync both toggles
        if (themeToggle) themeToggle.checked = false;
        if (themeToggleMain) themeToggleMain.checked = false;
      }
    }
    
    // Backup Data
    function backupData() {
      try {
        const data = {
          orders: localStorage.getItem('chefos_orders'),
          completedOrders: localStorage.getItem('chefos_completed_orders'),
          inventory: localStorage.getItem('chefos_inventory'),
          inventoryDetailed: localStorage.getItem('chefos_inventory_detailed'),
          cart: localStorage.getItem('chefos_cart'),
          theme: localStorage.getItem('theme'),
          backupDate: new Date().toISOString(),
          system: 'ChefOS POS'
        };
        
        const dataStr = JSON.stringify(data, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `chefos-backup-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        URL.revokeObjectURL(url);
        
        alert('✅ Data backup downloaded successfully!');
      } catch (error) {
        console.error('Backup failed:', error);
        alert('❌ Backup failed. Please try again.');
      }
    }
    
    // Clear All Data
    function clearData() {
      if (!confirm('⚠️ Are you sure you want to clear ALL data? This cannot be undone!')) return;
      if (!confirm('⚠️ FINAL WARNING: This will delete all orders, inventory, and settings!')) return;
      
      try {
        localStorage.removeItem('chefos_orders');
        localStorage.removeItem('chefos_completed_orders');
        localStorage.removeItem('chefos_inventory');
        localStorage.removeItem('chefos_inventory_detailed');
        localStorage.removeItem('chefos_cart');
        
        alert('✅ All data has been cleared!');
        window.location.reload();
      } catch (error) {
        console.error('Clear data failed:', error);
        alert('❌ Failed to clear data. Please try again.');
      }
    }
    
    // Update Time - Matching POS Page Format
    function updateTime() {
      const now = new Date();
      const dateTimeString = now.toISOString();
      const formattedDate = now.toLocaleString('en-US', { 
        weekday: 'short',
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      });
      
      const clockText = document.getElementById('clockText');
      if (clockText) {
        clockText.textContent = formattedDate;
        clockText.setAttribute('datetime', dateTimeString);
      }
    }
    
    // Initialize everything
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize theme
      initializeTheme();
      
      // Setup theme toggles
      if (themeToggle) themeToggle.addEventListener('change', toggleTheme);
      if (themeToggleMain) themeToggleMain.addEventListener('change', toggleTheme);
      
      // Initialize time
      updateTime();
      setInterval(updateTime, 1000);
      
      // Add keyboard navigation for settings cards
      const settingCards = document.querySelectorAll('.setting-card');
      settingCards.forEach((card, index) => {
        card.setAttribute('tabindex', '0');
        card.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const button = card.querySelector('button');
            if (button) button.click();
          } else if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
            e.preventDefault();
            const nextCard = settingCards[(index + 1) % settingCards.length];
            nextCard.focus();
          } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
            e.preventDefault();
            const prevCard = settingCards[(index - 1 + settingCards.length) % settingCards.length];
            prevCard.focus();
          }
        });
      });
      
      // Add visual hidden CSS
      const style = document.createElement('style');
      style.textContent = `
        .visually-hidden {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }
        
        .settings-container {
          padding: 20px;
          max-height: calc(100vh - 75px);
          overflow-y: auto;
        }
        
        .settings-container h2 {
          color: var(--primary);
          display: flex;
          align-items: center;
          gap: 10px;
          margin: 0 0 30px 0;
        }
        
        .settings-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }
        
        .setting-card {
          background: var(--white);
          border-radius: 12px;
          padding: 20px;
          box-shadow: var(--shadow);
          border: 1px solid var(--gray-light);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
          height: 100%;
          display: flex;
          flex-direction: column;
        }
        
        .setting-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .setting-card h3 {
          margin: 0 0 10px 0;
          color: var(--dark);
          display: flex;
          align-items: center;
          gap: 10px;
        }
        
        .setting-card p {
          color: var(--gray);
          margin: 0 0 20px 0;
          flex-grow: 1;
        }
        
        .btn {
          padding: 10px 20px;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          font-weight: 600;
          transition: all 0.3s ease;
          display: inline-flex;
          align-items: center;
          gap: 8px;
        }
        
        .btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
          background: var(--primary);
          color: white;
        }
        
        .btn-secondary {
          background: var(--gray-light);
          color: var(--dark);
        }
        
        .btn-success {
          background: #28a745;
          color: white;
        }
        
        .btn-danger {
          background: #e74c3c;
          color: white;
        }
        
        /* Dark theme adjustments */
        .dark-theme .setting-card {
          background: #2d3748;
          border-color: #4a5568;
        }
        
        .dark-theme .setting-card h3 {
          color: #fff;
        }
        
        .dark-theme .setting-card p {
          color: #cbd5e0;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
          .settings-grid {
            grid-template-columns: 1fr;
          }
          
          .settings-container h2 {
            font-size: 24px;
          }
        }
        
        @media (max-width: 480px) {
          .settings-container {
            padding: 15px;
          }
          
          .setting-card {
            padding: 15px;
          }
          
          .btn {
            padding: 8px 16px;
            font-size: 14px;
          }
        }
      `;
      document.head.appendChild(style);
    });
  </script>
</body>
</html>
